<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TimerCount and GetApi Data</title>
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="css/myStyle.css">
</head>
<body>
 
<!-- â“ **é¡Œç›®æ•˜è¿°**

  è«‹ä½¿ç”¨Vue2å®Œæˆä¸€å€‹é é¢ï¼Œéœ€æ±‚å¦‚ä¸‹ï¼š

  1. å½ˆå‡ºä¸€å€‹popup windowï¼Œå‘ˆç¾å‡ºå¾ç¾åœ¨é–‹å§‹çš„å€’æ•¸æ™‚é–“ï¼Œæˆªæ­¢æ—¥ç‚º2023-02-28 æ—¥æœŸæ ¼å¼ç‚ºdd HH:mm:ss
  2. [https://testnet.binancefuture.com/dapi/v1/premiumIndex](https://testnet.binancefuture.com/dapi/v1/premiumIndex) è«‹ä½¿ç”¨æ­¤APIåœ¨é é¢ä¸Šç§€å‡º
      1. äº¤æ˜“å° Symbolï¼šè²¨å¹£äº¤æ˜“å°ï¼Œä¾‹å¦‚
      2. æ¨™è¨˜åƒ¹æ ¼ Mark Price
      3. æŒ‡æ•¸åƒ¹æ ¼ Index Price
      4. ä¸‹æ¬¡è³‡é‡‘è²»ç‡çµç®—æ™‚é–“ Next Funding Time

**ğŸ’¡Â å¯ä½¿ç”¨ä»»æ„å¥—ä»¶å®Œæˆé¡Œç›®ï¼** -->
<div class="container">
 
  <div id="app">
    <!-- <button @click="getApiData">æ‹¿è³‡æ–™</button> -->
     <h1>Coutdown my Date</h1>
     <p>ä»Šå¤©æ—¥æœŸç‚º:{{nowDate.toLocaleDateString()}} </p>
     <p>æˆªæ­¢æ—¥æœŸç‚º:{{finshedData.toLocaleDateString()}} </p>
     <div class="counter-view">
      <h6>Your</h6>
        <ul class="counter">
          <li class="days" data-content="Days">{{display.days}}</li>
          <li class="hours" data-content="Hours">{{display.hours}}</li>
          <li class="mins" data-content="Mins">{{display.mins}}</li>
          <li class="secs" data-content="Secs">{{display.secs}}</li>
        </ul>
     </div>
     <hr>
    <button type="button" class="btn" @click="getApiData">Get Data</button>

    <ul class="dataList">
        <li v-for="(item, index) in itemsCovert" :key="index" >
          {{ item.computedValue }}
        </li>
  </ul>
  </div>

</div>
  

  <!-- é€™äº›å°ˆæ¥­åè©æ˜¯èˆ‡åŠ å¯†è²¨å¹£äº¤æ˜“æ‰€ç›¸é—œçš„è¡“èªï¼Œé€šå¸¸è¢«ä½¿ç”¨åœ¨åŠ å¯†è²¨å¹£çš„æœŸè²¨äº¤æ˜“å¸‚å ´ä¸­ã€‚ä»¥ä¸‹æ˜¯ç›¸å°æ‡‰çš„ä¸­æ–‡åè©è§£é‡‹ï¼š

  Symbolï¼šè²¨å¹£äº¤æ˜“å°ï¼Œä¾‹å¦‚ BTC/USDT æˆ– ETH/BTC ç­‰ã€‚
  Pairï¼šåŒ Symbolï¼Œä¹Ÿæ˜¯è²¨å¹£äº¤æ˜“å°ã€‚
  Mark Priceï¼šå¸‚åƒ¹ï¼Œæ˜¯åŸºæ–¼äº¤æ˜“æ‰€æ›å–®åƒ¹æ ¼å¹³å‡å€¼è¨ˆç®—å‡ºçš„æŒ‡æ•¸åƒ¹æ ¼ã€‚
  Index Priceï¼šæŒ‡æ•¸åƒ¹æ ¼ï¼Œæ˜¯å¸‚å ´ä¸Šå¹¾å®¶ä¸»è¦äº¤æ˜“æ‰€çš„åŠ æ¬Šå¹³å‡åƒ¹æ ¼ã€‚
  Estimated Settle Priceï¼šé ä¼°çµç®—åƒ¹æ ¼ï¼Œæ˜¯åŸºæ–¼æ¨™çš„æŒ‡æ•¸åƒ¹æ ¼è¨ˆç®—å‡ºçš„çµç®—åƒ¹æ ¼ã€‚
  Last Funding Rateï¼šæœ€å¾Œä¸€æ¬¡è³‡é‡‘è²»ç‡ï¼Œæ˜¯ç”¨æ–¼èª¿æ•´æŒå€‰çš„è²»ç‡ï¼Œç”±å¤šç©ºé›™æ–¹ä¹‹é–“äº’ç›¸æ”¯ä»˜ã€‚
  Interest Rateï¼šåˆ©ç‡ï¼Œæ˜¯æŒ‡ç”¨æ–¼è¨ˆç®—è³‡é‡‘è²»ç‡çš„åŸºæº–åˆ©ç‡ã€‚
  Next Funding Timeï¼šä¸‹ä¸€æ¬¡è³‡é‡‘è²»ç‡çµç®—æ™‚é–“ï¼Œæ˜¯å¤šç©ºé›™æ–¹äº¤æ›è²»ç‡çš„æ™‚é–“ã€‚
  Timeï¼šæ™‚é–“ï¼ŒæŒ‡äº¤æ˜“æˆ–å…¶ä»–ç›¸é—œäº‹ä»¶ç™¼ç”Ÿçš„æ™‚é–“ã€‚ -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>   
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.all.min.js"></script>
  <script src="https://unpkg.com/vue@2"></script>
  <script>
       
  </script>
  <script>
    const app = new Vue({
      el: '#app',
      data: {
        message: 'Hello Vue!',
        apiData:[],

        // ç•¶å‰æ—¥æœŸ
        nowDate:new Date(),

        // æˆªæ­¢æ—¥æœŸ
        finshedData:new Date(2023,1,28,23,59,59,59),
        isGeted:false,
        // è¨ˆæ•¸å™¨
        display:{
          days:0,
          hours:0,
          mins:0,
          secs:0
        }
      },
      methods: {
        getApiData(){
          _this = this;
          Swal.fire({
              title: 'Are you sure?',
              // title: 'Error!',
              text: 'Do you want to get ApiData?',
              icon: 'info',
              confirmButtonText: 'OK',
              confirmButtonColor: '#3085d6',
              
              showCancelButton: true,
              cancelButtonText:'Empty DataList',
              cancelButtonColor: '#d33',
            }).then((result) => {
                if (result.isConfirmed && !_this.isGeted) {
                  Swal.fire(
                    'Api DataList update',
                    'Please check your DataList.',
                    'success'
                  )
                  axios
                  .get('https://testnet.binancefuture.com/dapi/v1/premiumIndex')
                  .then(res =>{
                    // console.log(res.data)
                    _this.apiData = [];
                    res.data.forEach(el => {
                      _this.apiData.push(el);
                    });
                    console.log(this.apiData);
                    _this.isGeted = true;
                  })
                  .catch(function (error) { 
                    console.log(error);
                  });

                }else{
                   _this.apiData = [];
                    _this.isGeted = false;
                }
              })


         
        },
        showRemain(){
          // å•Ÿå‹•è¨ˆæ™‚å™¨
          const timer = setInterval(()=>{
          const now = new Date();
          const end = this.finshedData;

          const timeDiff = end.getTime() - now.getTime();
            
          if(timeDiff < 0){
            clearInterval(timer)
            return alert('timer over')
          }

          const days = Math.floor(timeDiff / this._days);
          const hours = Math.floor(timeDiff % this._days / this._hours);
          const mins = Math.floor(timeDiff % this._hours / this._mins);
          const secs = Math.floor(timeDiff % this._mins / this._secs);

          // DD HH:MM:SS æ™‚é–“æ ¼å¼
          this.display.mins = mins < 10 ? "0" + mins :mins;
          this.display.secs = secs < 10 ? "0" + secs :secs;
          this.display.hours = hours < 10 ? "0" + hours :hours;
          this.display.days = days < 10 ? "0" + days :days;
          },800)
       
        },
       
      },
      mounted: function(){
        this.showRemain()
      },
      computed:{
        _secs:()=>1000,
        _mins(){
          return this._secs* 60;
        },
        _hours(){
          return this._mins * 60;
        },
        _days(){
          return this._hours * 24;
        },

        itemsCovert() {
          return this.apiData.map(item => {
          // console.log(item.nextFundingTime)
          console.log(item)
 
          // 1. äº¤æ˜“å° Symbolï¼šè²¨å¹£äº¤æ˜“å°ï¼Œä¾‹å¦‚
          const symbol = item.symbol;
          // 2. æ¨™è¨˜åƒ¹æ ¼ Mark Price
          const markPrice = item.markPrice;
          // 3. æŒ‡æ•¸åƒ¹æ ¼ Index Price
          const indexPrice = item.indexPrice;
          
          // 4. ä¸‹æ¬¡è³‡é‡‘è²»ç‡çµç®—æ™‚é–“ Next Funding Time
          // const totalSeconds = Math.floor(item.time / 1000);
          const totalSeconds = Math.floor(item.nextFundingTime / 1000);
          const seconds = totalSeconds % 60;
          const totalMinutes = Math.floor(totalSeconds / 60);
          const minutes = totalMinutes % 60;
          const totalHours = Math.floor(totalMinutes / 60);
          const hours = totalHours % 24;
          const days = Math.floor(totalHours / 24);
          console.log(days)
            return {
              computedValue:`
              Symbol:${symbol},
              markPrice:${markPrice},
              indexPrice:${indexPrice},---
              ${days.toString().padStart(2, '0')}, 
              ${hours.toString().padStart(2, '0')}
              :${minutes.toString().padStart(2, '0')}
              :${seconds.toString().padStart(2, '0')}`,
            };
          });
         },
          
      }
    })
  </script>  
</body>
</html>